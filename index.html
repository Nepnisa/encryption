<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ” å¤šè¯­è¨€åŠ å¯†å·¥å…· - Webç‰ˆ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-primary: #f5f5f7;
            --bg-secondary: #ffffff;
            --text-primary: #2c3e50;
            --text-secondary: #7f8c8d;
            --accent: #3498db;
            --success: #27ae60;
            --warning: #e67e22;
            --border: #e0e0e0;
            --shadow: rgba(0, 0, 0, 0.08);
            --transition: all 0.3s ease;
        }

        .dark-mode {
            --bg-primary: #1a1a2e;
            --bg-secondary: #16213e;
            --text-primary: #e6e6e6;
            --text-secondary: #b0b0b0;
            --accent: #4cc9f0;
            --success: #4ade80;
            --warning: #fbbf24;
            --border: #2d3748;
            --shadow: rgba(0, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }

        body {
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            transition: var(--transition);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* å¤´éƒ¨æ ·å¼ */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--accent);
        }

        .title-section h1 {
            font-size: 2.2rem;
            margin-bottom: 8px;
            background: linear-gradient(135deg, var(--accent), #9b59b6);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            display: inline-block;
        }

        .title-section p {
            color: var(--text-secondary);
            font-size: 1rem;
        }

        .controls-top {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        /* ä¸»é¢˜åˆ‡æ¢æŒ‰é’® */
        .theme-toggle {
            background: var(--bg-secondary);
            border: 2px solid var(--border);
            border-radius: 50px;
            width: 60px;
            height: 30px;
            position: relative;
            cursor: pointer;
            transition: var(--transition);
        }

        .theme-toggle::after {
            content: '';
            position: absolute;
            top: 3px;
            left: 3px;
            width: 22px;
            height: 22px;
            background: var(--accent);
            border-radius: 50%;
            transition: var(--transition);
        }

        .dark-mode .theme-toggle::after {
            transform: translateX(30px);
            background: var(--warning);
        }

        .theme-icon {
            font-size: 1.2rem;
            margin-left: 10px;
        }

        /* ä¸»å†…å®¹åŒºåŸŸ */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 8px 30px var(--shadow);
            border: 1px solid var(--border);
            transition: var(--transition);
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px var(--shadow);
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
        }

        .card-header i {
            font-size: 1.5rem;
            margin-right: 12px;
            color: var(--accent);
        }

        .card-header h2 {
            font-size: 1.5rem;
            font-weight: 600;
        }

        /* æ–‡æœ¬åŒºåŸŸ */
        .text-area-container {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .text-area-wrapper {
            flex: 1;
            border: 1px solid var(--border);
            border-radius: 10px;
            overflow: hidden;
            background: var(--bg-primary);
        }

        textarea {
            width: 100%;
            height: 100%;
            min-height: 300px;
            padding: 20px;
            border: none;
            background: transparent;
            color: var(--text-primary);
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 15px;
            line-height: 1.5;
            resize: none;
            outline: none;
            transition: var(--transition);
        }

        textarea:focus {
            background: rgba(52, 152, 219, 0.03);
        }

        .char-count {
            text-align: right;
            margin-top: 10px;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* æŒ‰é’®åŒºåŸŸ */
        .button-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 30px 0;
        }

        .btn {
            padding: 14px 20px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: var(--transition);
        }

        .btn i {
            font-size: 1.1rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent), #2980b9);
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #2980b9, var(--accent));
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success), #219653);
            color: white;
        }

        .btn-success:hover {
            background: linear-gradient(135deg, #219653, var(--success));
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.3);
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning), #d35400);
            color: white;
        }

        .btn-warning:hover {
            background: linear-gradient(135deg, #d35400, var(--warning));
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(230, 126, 34, 0.3);
        }

        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--bg-primary);
            transform: translateY(-2px);
        }

        /* çŠ¶æ€æ  */
        .status-bar {
            background: var(--bg-secondary);
            border-radius: 10px;
            padding: 15px 25px;
            margin-top: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid var(--border);
            font-size: 0.95rem;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-icon {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--success);
        }

        .status-icon.error {
            background: #e74c3c;
        }

        .status-icon.warning {
            background: var(--warning);
        }

        .status-icon.idle {
            background: var(--text-secondary);
        }

        /* å¿«æ·é”®æç¤º */
        .shortcuts {
            margin-top: 30px;
            padding: 20px;
            background: var(--bg-secondary);
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        .shortcuts h3 {
            margin-bottom: 15px;
            color: var(--accent);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .shortcut-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
        }

        .shortcut-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 15px;
            background: var(--bg-primary);
            border-radius: 8px;
            border-left: 4px solid var(--accent);
        }

        .shortcut-key {
            background: var(--bg-secondary);
            padding: 4px 10px;
            border-radius: 5px;
            font-family: monospace;
            font-weight: bold;
            color: var(--accent);
            border: 1px solid var(--border);
        }

        /* é€šçŸ¥ */
        .notification {
            position: fixed;
            top: 30px;
            right: 30px;
            padding: 15px 25px;
            border-radius: 10px;
            background: var(--success);
            color: white;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
            transform: translateX(150%);
            transition: transform 0.4s ease;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 12px;
            max-width: 350px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.error {
            background: #e74c3c;
        }

        .notification.warning {
            background: var(--warning);
        }

        /* å“åº”å¼è°ƒæ•´ */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            header {
                flex-direction: column;
                align-items: flex-start;
                gap: 20px;
            }
            
            .controls-top {
                align-self: flex-end;
            }
            
            .button-section {
                grid-template-columns: 1fr;
            }
            
            .status-bar {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }
            
            .shortcut-grid {
                grid-template-columns: 1fr;
            }
        }

        /* æ»šåŠ¨æ¡ç¾åŒ– */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-primary);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--accent);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #2980b9;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- å¤´éƒ¨ -->
        <header>
            <div class="title-section">
                <h1><i class="fas fa-lock"></i> å¤šè¯­è¨€åŠ å¯†å·¥å…·</h1>
                <p>å°†ä»»æ„æ–‡æœ¬åŠ å¯†ä¸ºä»…åŒ…å«ç‰¹å®šå­—ç¬¦é›†çš„å­—ç¬¦ä¸²ï¼Œå¹¶å¯å®Œç¾è¿˜åŸ | ç‰ˆæœ¬ 1.1.4697 Â· Webç‰ˆ</p>
            </div>
            <div class="controls-top">
                <div class="theme-toggle" id="themeToggle"></div>
                <span class="theme-icon" id="themeIcon">ğŸŒ™</span>
            </div>
        </header>

        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <div class="main-content">
            <!-- è¾“å…¥åŒºåŸŸ -->
            <div class="card">
                <div class="card-header">
                    <i class="fas fa-keyboard"></i>
                    <h2>ğŸ“¥ è¾“å…¥æ–‡æœ¬</h2>
                </div>
                <div class="text-area-container">
                    <div class="text-area-wrapper">
                        <textarea id="inputText" placeholder="åœ¨æ­¤è¾“å…¥è¦åŠ å¯†æˆ–è§£å¯†çš„æ–‡æœ¬..."></textarea>
                    </div>
                    <div class="char-count">
                        å­—ç¬¦æ•°: <span id="inputCharCount">0</span>
                    </div>
                </div>
            </div>

            <!-- è¾“å‡ºåŒºåŸŸ -->
            <div class="card">
                <div class="card-header">
                    <i class="fas fa-file-code"></i>
                    <h2>ğŸ“¤ è¾“å‡ºç»“æœ</h2>
                </div>
                <div class="text-area-container">
                    <div class="text-area-wrapper">
                        <textarea id="outputText" readonly placeholder="åŠ å¯†æˆ–è§£å¯†çš„ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..."></textarea>
                    </div>
                    <div class="char-count">
                        å­—ç¬¦æ•°: <span id="outputCharCount">0</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- æŒ‰é’®åŒºåŸŸ -->
        <div class="button-section">
            <button class="btn btn-primary" id="encryptBtn">
                <i class="fas fa-lock"></i> åŠ å¯† â†’
            </button>
            <button class="btn btn-success" id="decryptBtn">
                <i class="fas fa-unlock"></i> è§£å¯† â†
            </button>
            <button class="btn btn-warning" id="clearBtn">
                <i class="fas fa-trash-alt"></i> æ¸…ç©º
            </button>
            <button class="btn btn-secondary" id="copyBtn">
                <i class="fas fa-copy"></i> å¤åˆ¶ç»“æœ
            </button>
            <button class="btn btn-secondary" id="pasteBtn">
                <i class="fas fa-paste"></i> ç²˜è´´åˆ°è¾“å…¥
            </button>
            <button class="btn btn-secondary" id="aboutBtn">
                <i class="fas fa-info-circle"></i> å…³äº
            </button>
        </div>

        <!-- çŠ¶æ€æ  -->
        <div class="status-bar">
            <div class="status-item">
                <div class="status-icon idle" id="statusIcon"></div>
                <span id="statusText">å°±ç»ªï¼ˆå­—ç¬¦é›†å¤§å°: <span id="charsetSize">0</span>ï¼‰</span>
            </div>
            <div class="status-item">
                <i class="fas fa-bolt"></i>
                <span>çº¯å‰ç«¯å®ç° Â· æ— éœ€ç½‘ç»œ</span>
            </div>
        </div>

        <!-- å¿«æ·é”®æç¤º -->
        <div class="shortcuts">
            <h3><i class="fas fa-keyboard"></i> é”®ç›˜å¿«æ·é”®</h3>
            <div class="shortcut-grid">
                <div class="shortcut-item">
                    <span>åŠ å¯†æ–‡æœ¬</span>
                    <kbd class="shortcut-key">Ctrl + Enter</kbd>
                </div>
                <div class="shortcut-item">
                    <span>è§£å¯†æ–‡æœ¬</span>
                    <kbd class="shortcut-key">Ctrl + Shift + Enter</kbd>
                </div>
                <div class="shortcut-item">
                    <span>å¤åˆ¶ç»“æœ</span>
                    <kbd class="shortcut-key">Ctrl + C</kbd>
                </div>
                <div class="shortcut-item">
                    <span>ç²˜è´´åˆ°è¾“å…¥</span>
                    <kbd class="shortcut-key">Ctrl + V</kbd>
                </div>
                <div class="shortcut-item">
                    <span>æ¸…ç©ºæ‰€æœ‰</span>
                    <kbd class="shortcut-key">Ctrl + Delete</kbd>
                </div>
            </div>
        </div>
    </div>

    <!-- é€šçŸ¥ -->
    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i>
        <span id="notificationText">æ“ä½œæˆåŠŸ</span>
    </div>

    <script>
        // ========== åŠ å¯†æ ¸å¿ƒé€»è¾‘ï¼ˆJavaScriptç§»æ¤ç‰ˆï¼‰==========
        class MultiLangEncryptor {
            constructor() {
                this.charset = this.buildCharset();
                this.M = this.charset.length;
                this.charToIndex = new Map();
                this.charset.forEach((c, i) => this.charToIndex.set(c, i));
            }

            // æ„å»ºå­—ç¬¦é›†ï¼ˆä¸Pythonç‰ˆæœ¬å®Œå…¨ä¸€è‡´ï¼‰
            buildCharset() {
                const chars = new Set();
                
                // æ‹‰ä¸å­—æ¯
                for (let i = 65; i <= 90; i++) chars.add(String.fromCharCode(i)); // A-Z
                for (let i = 97; i <= 122; i++) chars.add(String.fromCharCode(i)); // a-z
                
                // è¥¿é‡Œå°”å­—æ¯
                for (let i = 0x0400; i <= 0x04FF; i++) {
                    try {
                        const char = String.fromCodePoint(i);
                        const name = char.codePointAt(0).toString(16);
                        if (name.includes('cyrillic') || (i >= 0x0400 && i <= 0x04FF)) {
                            chars.add(char);
                        }
                    } catch (e) {
                        // å¿½ç•¥æ— æ•ˆå­—ç¬¦
                    }
                }
                
                // å¸Œè…Šå­—æ¯
                for (let i = 0x0370; i <= 0x03FF; i++) {
                    try {
                        const char = String.fromCodePoint(i);
                        const name = char.codePointAt(0).toString(16);
                        if (name.includes('greek') || (i >= 0x0370 && i <= 0x03FF)) {
                            chars.add(char);
                        }
                    } catch (e) {
                        // å¿½ç•¥æ— æ•ˆå­—ç¬¦
                    }
                }
                
                // å›½é™…éŸ³æ ‡
                for (let i = 0x0250; i <= 0x02AF; i++) {
                    try {
                        chars.add(String.fromCodePoint(i));
                    } catch (e) {
                        // å¿½ç•¥æ— æ•ˆå­—ç¬¦
                    }
                }
                
                // æ’åºå¹¶è¿”å›æ•°ç»„
                return Array.from(chars).sort((a, b) => a.codePointAt(0) - b.codePointAt(0));
            }

            // åŠ å¯†å‡½æ•°
            encrypt(text) {
                try {
                    // å°†æ–‡æœ¬ç¼–ç ä¸ºUTF-8å­—èŠ‚æ•°ç»„
                    const encoder = new TextEncoder();
                    const data = encoder.encode(text);
                    
                    // æ·»åŠ é•¿åº¦å‰ç¼€ï¼ˆ4å­—èŠ‚å¤§ç«¯åºï¼‰
                    const lenBytes = new Uint8Array(4);
                    const lenView = new DataView(lenBytes.buffer);
                    lenView.setUint32(0, data.length, false); // big-endian
                    
                    // æ„å»ºå®Œæ•´å­—èŠ‚æ•°ç»„ï¼šå‰ç¼€(0x01) + é•¿åº¦ + æ•°æ®
                    const fullBytes = new Uint8Array(1 + 4 + data.length);
                    fullBytes[0] = 0x01; // å‰ç¼€
                    fullBytes.set(lenBytes, 1);
                    fullBytes.set(data, 5);
                    
                    // è½¬æ¢ä¸ºå¤§æ•´æ•°
                    let num = 0n;
                    for (let i = 0; i < fullBytes.length; i++) {
                        num = (num << 8n) | BigInt(fullBytes[i]);
                    }
                    
                    // è½¬æ¢ä¸ºå­—ç¬¦é›†è¡¨ç¤º
                    if (num === 0n) {
                        return this.charset[0];
                    }
                    
                    const digits = [];
                    let tempNum = num;
                    const M = BigInt(this.M);
                    
                    while (tempNum > 0n) {
                        const remainder = Number(tempNum % M);
                        tempNum = tempNum / M;
                        digits.push(this.charset[remainder]);
                    }
                    
                    digits.reverse();
                    return digits.join('');
                    
                } catch (error) {
                    throw new Error(`åŠ å¯†å¤±è´¥: ${error.message}`);
                }
            }

            // è§£å¯†å‡½æ•°
            decrypt(encrypted) {
                try {
                    // éªŒè¯è¾“å…¥åªåŒ…å«å­—ç¬¦é›†ä¸­çš„å­—ç¬¦
                    for (const c of encrypted) {
                        if (!this.charToIndex.has(c)) {
                            throw new Error(`æ— æ•ˆå­—ç¬¦: ${c}`);
                        }
                    }
                    
                    // è½¬æ¢ä¸ºå¤§æ•´æ•°
                    let num = 0n;
                    const M = BigInt(this.M);
                    
                    for (const c of encrypted) {
                        num = num * M + BigInt(this.charToIndex.get(c));
                    }
                    
                    // è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„
                    const byteLength = Math.ceil(num.toString(2).length / 8);
                    const fullBytes = new Uint8Array(byteLength);
                    
                    let tempNum = num;
                    for (let i = byteLength - 1; i >= 0; i--) {
                        fullBytes[i] = Number(tempNum & 0xFFn);
                        tempNum >>= 8n;
                    }
                    
                    // éªŒè¯å‰ç¼€
                    if (fullBytes[0] !== 0x01) {
                        throw new Error("æ— æ•ˆçš„åŠ å¯†æ•°æ®ï¼šå‰ç¼€é”™è¯¯");
                    }
                    
                    // æå–é•¿åº¦
                    const lenView = new DataView(fullBytes.buffer, 1, 4);
                    const length = lenView.getUint32(0, false); // big-endian
                    
                    // æå–æ•°æ®
                    const data = fullBytes.slice(5, 5 + length);
                    
                    // è§£ç ä¸ºæ–‡æœ¬
                    const decoder = new TextDecoder('utf-8');
                    return decoder.decode(data);
                    
                } catch (error) {
                    throw new Error(`è§£å¯†å¤±è´¥: ${error.message}`);
                }
            }

            // è·å–å­—ç¬¦é›†å¤§å°
            getCharsetSize() {
                return this.M;
            }

            // è·å–å­—ç¬¦é›†é¢„è§ˆ
            getCharsetPreview() {
                return this.charset.slice(0, 50).join('') + (this.M > 50 ? '...' : '');
            }
        }

        // ========== ç•Œé¢äº¤äº’é€»è¾‘ ==========
        class EncryptorUI {
            constructor() {
                this.encryptor = new MultiLangEncryptor();
                this.initElements();
                this.initEventListeners();
                this.initTheme();
                this.updateCharCounts();
                this.updateCharsetSize();
            }

            initElements() {
                this.inputText = document.getElementById('inputText');
                this.outputText = document.getElementById('outputText');
                this.inputCharCount = document.getElementById('inputCharCount');
                this.outputCharCount = document.getElementById('outputCharCount');
                this.charsetSize = document.getElementById('charsetSize');
                this.statusIcon = document.getElementById('statusIcon');
                this.statusText = document.getElementById('statusText');
                this.notification = document.getElementById('notification');
                this.notificationText = document.getElementById('notificationText');
                this.themeToggle = document.getElementById('themeToggle');
                this.themeIcon = document.getElementById('themeIcon');
                
                // æŒ‰é’®
                this.encryptBtn = document.getElementById('encryptBtn');
                this.decryptBtn = document.getElementById('decryptBtn');
                this.clearBtn = document.getElementById('clearBtn');
                this.copyBtn = document.getElementById('copyBtn');
                this.pasteBtn = document.getElementById('pasteBtn');
                this.aboutBtn = document.getElementById('aboutBtn');
            }

            initEventListeners() {
                // è¾“å…¥æ¡†äº‹ä»¶
                this.inputText.addEventListener('input', () => this.updateCharCounts());
                
                // æŒ‰é’®äº‹ä»¶
                this.encryptBtn.addEventListener('click', () => this.encrypt());
                this.decryptBtn.addEventListener('click', () => this.decrypt());
                this.clearBtn.addEventListener('click', () => this.clearAll());
                this.copyBtn.addEventListener('click', () => this.copyOutput());
                this.pasteBtn.addEventListener('click', () => this.pasteInput());
                this.aboutBtn.addEventListener('click', () => this.showAbout());
                
                // ä¸»é¢˜åˆ‡æ¢
                this.themeToggle.addEventListener('click', () => this.toggleTheme());
                
                // é”®ç›˜å¿«æ·é”®
                document.addEventListener('keydown', (e) => this.handleShortcuts(e));
            }

            initTheme() {
                const savedTheme = localStorage.getItem('encryptor-theme');
                if (savedTheme === 'dark') {
                    document.body.classList.add('dark-mode');
                    this.themeIcon.textContent = 'â˜€ï¸';
                }
            }

            toggleTheme() {
                document.body.classList.toggle('dark-mode');
                if (document.body.classList.contains('dark-mode')) {
                    localStorage.setItem('encryptor-theme', 'dark');
                    this.themeIcon.textContent = 'â˜€ï¸';
                } else {
                    localStorage.setItem('encryptor-theme', 'light');
                    this.themeIcon.textContent = 'ğŸŒ™';
                }
            }

            updateCharCounts() {
                const inputLength = this.inputText.value.length;
                const outputLength = this.outputText.value.length;
                this.inputCharCount.textContent = inputLength;
                this.outputCharCount.textContent = outputLength;
            }

            updateCharsetSize() {
                const size = this.encryptor.getCharsetSize();
                this.charsetSize.textContent = size;
                this.statusText.textContent = `å°±ç»ªï¼ˆå­—ç¬¦é›†å¤§å°: ${size}ï¼‰`;
            }

            setStatus(message, type = 'idle') {
                this.statusText.textContent = message;
                this.statusIcon.className = 'status-icon ' + type;
            }

            showNotification(message, type = 'success') {
                this.notificationText.textContent = message;
                this.notification.className = 'notification ' + type;
                this.notification.classList.add('show');
                
                setTimeout(() => {
                    this.notification.classList.remove('show');
                }, 3000);
            }

            encrypt() {
                const input = this.inputText.value.trim();
                if (!input) {
                    this.showNotification('è¯·è¾“å…¥è¦åŠ å¯†çš„æ–‡æœ¬', 'warning');
                    return;
                }

                try {
                    this.setStatus('åŠ å¯†ä¸­...', 'warning');
                    const result = this.encryptor.encrypt(input);
                    this.outputText.value = result;
                    this.updateCharCounts();
                    this.setStatus(`âœ… åŠ å¯†å®Œæˆï¼Œé•¿åº¦: ${result.length}`, 'success');
                    this.showNotification('æ–‡æœ¬åŠ å¯†æˆåŠŸ');
                } catch (error) {
                    this.setStatus('âŒ åŠ å¯†å¤±è´¥', 'error');
                    this.showNotification(`åŠ å¯†å¤±è´¥: ${error.message}`, 'error');
                }
            }

            decrypt() {
                const input = this.inputText.value.trim();
                if (!input) {
                    this.showNotification('è¯·è¾“å…¥è¦è§£å¯†çš„æ–‡æœ¬', 'warning');
                    return;
                }

                try {
                    this.setStatus('è§£å¯†ä¸­...', 'warning');
                    const result = this.encryptor.decrypt(input);
                    this.outputText.value = result;
                    this.updateCharCounts();
                    this.setStatus('âœ… è§£å¯†å®Œæˆ', 'success');
                    this.showNotification('æ–‡æœ¬è§£å¯†æˆåŠŸ');
                } catch (error) {
                    this.setStatus('âŒ è§£å¯†å¤±è´¥', 'error');
                    this.showNotification(`è§£å¯†å¤±è´¥: ${error.message}`, 'error');
                }
            }

            clearAll() {
                this.inputText.value = '';
                this.outputText.value = '';
                this.updateCharCounts();
                this.setStatus('ğŸ§¹ å·²æ¸…ç©º', 'idle');
                this.showNotification('å·²æ¸…ç©ºæ‰€æœ‰å†…å®¹');
            }

            async copyOutput() {
                const output = this.outputText.value;
                if (!output) {
                    this.showNotification('è¾“å‡ºä¸ºç©ºï¼Œæ— å†…å®¹å¯å¤åˆ¶', 'warning');
                    return;
                }

                try {
                    await navigator.clipboard.writeText(output);
                    this.setStatus('ğŸ“‹ ç»“æœå·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
                    this.showNotification('ç»“æœå·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
                    setTimeout(() => {
                        this.setStatus(`å°±ç»ªï¼ˆå­—ç¬¦é›†å¤§å°: ${this.encryptor.getCharsetSize()}ï¼‰`, 'idle');
                    }, 2000);
                } catch (error) {
                    this.showNotification('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶', 'error');
                }
            }

            async pasteInput() {
                try {
                    const text = await navigator.clipboard.readText();
                    this.inputText.value = text;
                    this.updateCharCounts();
                    this.setStatus('ğŸ“‹ å·²ä»å‰ªè´´æ¿ç²˜è´´', 'success');
                    this.showNotification('å·²ä»å‰ªè´´æ¿ç²˜è´´å†…å®¹');
                    setTimeout(() => {
                        this.setStatus(`å°±ç»ªï¼ˆå­—ç¬¦é›†å¤§å°: ${this.encryptor.getCharsetSize()}ï¼‰`, 'idle');
                    }, 2000);
                } catch (error) {
                    this.showNotification('æ— æ³•è¯»å–å‰ªè´´æ¿å†…å®¹', 'error');
                }
            }

            showAbout() {
                const aboutText = `ğŸ” å¤šè¯­è¨€åŠ å¯†å·¥å…·
ç‰ˆæœ¬ 1.1.4697 Â· Webç‰ˆ

å°†ä»»æ„æ–‡æœ¬åŠ å¯†ä¸ºä»…åŒ…å«æ‹‰ä¸å­—æ¯ã€è¥¿é‡Œå°”å­—æ¯ã€
å¸Œè…Šå­—æ¯å’Œå›½é™…éŸ³æ ‡çš„å­—ç¬¦ä¸²ï¼Œå¹¶å¯å®Œç¾è¿˜åŸã€‚

å­—ç¬¦é›†å¤§å°: ${this.encryptor.getCharsetSize()}
å­—ç¬¦é›†é¢„è§ˆ: ${this.encryptor.getCharsetPreview()}

Â© 2026 Nepnisa`;

                alert(aboutText);
            }

            handleShortcuts(e) {
                // Ctrl + Enter: åŠ å¯†
                if (e.ctrlKey && e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    this.encrypt();
                }
                
                // Ctrl + Shift + Enter: è§£å¯†
                if (e.ctrlKey && e.shiftKey && e.key === 'Enter') {
                    e.preventDefault();
                    this.decrypt();
                }
                
                // Ctrl + C: å¤åˆ¶ç»“æœ
                if (e.ctrlKey && e.key === 'c' && document.activeElement !== this.inputText) {
                    e.preventDefault();
                    this.copyOutput();
                }
                
                // Ctrl + V: ç²˜è´´åˆ°è¾“å…¥
                if (e.ctrlKey && e.key === 'v' && document.activeElement !== this.inputText) {
                    e.preventDefault();
                    this.pasteInput();
                }
                
                // Ctrl + Delete: æ¸…ç©ºæ‰€æœ‰
                if (e.ctrlKey && e.key === 'Delete') {
                    e.preventDefault();
                    this.clearAll();
                }
            }
        }

        // ========== åˆå§‹åŒ–åº”ç”¨ ==========
        document.addEventListener('DOMContentLoaded', () => {
            const app = new EncryptorUI();
            
            // æ·»åŠ ä¸€äº›ç¤ºä¾‹æ–‡æœ¬
            const inputText = document.getElementById('inputText');
            inputText.placeholder = `åœ¨æ­¤è¾“å…¥è¦åŠ å¯†æˆ–è§£å¯†çš„æ–‡æœ¬...

ç¤ºä¾‹æ–‡æœ¬ï¼š
1. ä½ å¥½ï¼Œä¸–ç•Œï¼Hello, World!
2. è¿™æ˜¯ä¸€ä¸ªå¤šè¯­è¨€åŠ å¯†æµ‹è¯•ã€‚
3. æ”¯æŒä¸­æ–‡ã€è‹±æ–‡ã€ç¬¦å·ç­‰ä»»æ„å†…å®¹ã€‚

åŠ å¯†åï¼Œæ–‡æœ¬å°†è¢«è½¬æ¢ä¸ºä»…åŒ…å«ç‰¹å®šå­—ç¬¦é›†çš„å­—ç¬¦ä¸²ã€‚`;
            
            // æ›´æ–°å­—ç¬¦é›†å¤§å°æ˜¾ç¤º
            setTimeout(() => {
                const charsetSize = document.getElementById('charsetSize');
                const encryptor = new MultiLangEncryptor();
                charsetSize.textContent = encryptor.getCharsetSize();
            }, 100);
        });
    </script>
</body>
</html>
